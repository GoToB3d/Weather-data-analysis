---
title: "Project"
author: "Qingdian Luo 2021013514"
output:
  pdf_document:
    latex_engine: xelatex
---

```{r}
# Load libraries
library(ggplot2)
library(dplyr)
library(lubridate)
library(tidyr)

# Read the data from CSV
data <- read.csv("data.csv")

# Convert Date to Date format
data$Date <- as.Date(data$Date)

# Extract month and year for time-based analysis
data$Year <- year(data$Date)
data$Month <- month(data$Date)

# For temperature, you may need to clean/remove the "℃" symbol and convert them to numeric values
data$Day.Temp <- as.numeric(gsub("℃", "", data$Day.Temp))
data$Night.Temp <- as.numeric(gsub("℃", "", data$Night.Temp))
```


```{r}
# Summary statistics for temperature (Day and Night)
summary_stats <- data %>%
  group_by(City) %>%
  summarise(
    Day_Temperature_Mean = mean(Day.Temp, na.rm = TRUE),
    Night_Temperature_Mean = mean(Night.Temp, na.rm = TRUE),
    Day_Temperature_Median = median(Day.Temp, na.rm = TRUE),
    Night_Temperature_Median = median(Night.Temp, na.rm = TRUE),
    Day_Temperature_Min = min(Day.Temp, na.rm = TRUE),
    Night_Temperature_Min = min(Night.Temp, na.rm = TRUE),
    Day_Temperature_Max = max(Day.Temp, na.rm = TRUE),
    Night_Temperature_Max = max(Night.Temp, na.rm = TRUE)
  )
print(summary_stats)

# Summary statistics for Wind Force
# Assuming you have numerical values for wind force, otherwise, you might need to convert them
# For simplicity, we assume a placeholder conversion function for wind force (e.g., '≤3级' as 3).
data$Day.Wind.Force <- gsub("级", "", data$Day.Wind.Force)
data$Night.Wind.Force <- gsub("级", "", data$Night.Wind.Force)

# Convert wind force to numeric (assumes categories like '≤3级', '3-4级', etc.)
data$Day.Wind.Force <- as.numeric(ifelse(data$Day.Wind.Force == "≤3", 3, ifelse(data$Day.Wind.Force == "3-4", 4, NA)))
data$Night.Wind.Force <- as.numeric(ifelse(data$Night.Wind.Force == "≤3", 3, ifelse(data$Night.Wind.Force == "3-4", 4, NA)))

# Wind force summary statistics
wind_stats <- data %>%
  group_by(City) %>%
  summarise(
    Day_Wind_Force_Mean = mean(Day.Wind.Force, na.rm = TRUE),
    Night_Wind_Force_Mean = mean(Night.Wind.Force, na.rm = TRUE),
    
    
    Day_Wind_Force_Max = max(Day.Wind.Force, na.rm = TRUE),
    Night_Wind_Force_Max = max(Night.Wind.Force, na.rm = TRUE)
  )
print(wind_stats)
```


```{r}
# Average temperature by month for each city
temperature_by_month <- data %>%
  group_by(City, Month) %>%
  summarise(
    Average_Day_Temperature = mean(Day.Temp, na.rm = TRUE),
    Average_Night_Temperature = mean(Night.Temp, na.rm = TRUE)
  )

# Plot temperature over time for each city
ggplot(temperature_by_month, aes(x = Month, y = Average_Day_Temperature, color = City)) +
  geom_line() +
  labs(title = "Average Day Temperature by Month for Each City", x = "Month", y = "Average Day Temperature (℃)") +
  theme_minimal()

# Yearly temperature trend for each city
temperature_by_year <- data %>%
  group_by(City, Year) %>%
  summarise(
    Average_Day_Temperature = mean(Day.Temp, na.rm = TRUE),
    Average_Night_Temperature = mean(Night.Temp, na.rm = TRUE)
  )

# Plot yearly temperature trend
ggplot(temperature_by_year, aes(x = Year, y = Average_Day_Temperature, color = City)) +
  geom_line() +
  labs(title = "Average Day Temperature by Year for Each City", x = "Year", y = "Average Day Temperature (℃)") +
  theme_minimal()
```

```{r}
# Count the occurrences of each weather condition (Day and Night) by city
weather_condition_day <- data %>%
  group_by(City, Day.Weather) %>%
  summarise(Count = n())

weather_condition_night <- data %>%
  group_by(City, Night.Weather) %>%
  summarise(Count = n())

# Plot weather condition occurrences (day)
ggplot(weather_condition_day, aes(x = Day.Weather, y = Count, fill = City)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Weather Condition Occurrences During Day for Each City", x = "Weather Condition", y = "Count") +
  theme_minimal()

ggplot(weather_condition_night, aes(x = Night.Weather, y = Count, fill = City)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Weather Condition Occurrences During Night for Each City", x = "Weather Condition", y = "Count") +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10) # Rotate labels by 45 degrees
  )
```

```{r}
# Compare average temperatures across cities
ggplot(data, aes(x = City, y = Day.Temp, fill = City)) +
  geom_boxplot() +
  labs(title = "Comparison of Day Temperatures Across Cities", y = "Day Temperature (℃)") +
  theme_minimal()

# Compare average wind force across cities
ggplot(data, aes(x = City, y = Day.Wind.Force, fill = City)) +
  geom_boxplot() +
  labs(title = "Comparison of Day Wind Force Across Cities", y = "Day Wind Force") +
  theme_minimal()

# ANOVA to test if there are significant differences in temperatures across cities
anova_result <- aov(Day.Temp ~ City, data = data)
summary(anova_result)
```

